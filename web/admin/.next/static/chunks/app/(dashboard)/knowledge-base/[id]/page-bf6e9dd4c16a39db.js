(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9201],{64064:(e,s,t)=>{Promise.resolve().then(t.bind(t,85682))},85682:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eh});var r=t(95155),a=t(12115),l=t(76046),n=t(48173),i=t.n(n),o=t(35906),d=t(39556),c=t(25848),m=t(93467),u=t(14081),x=t(86122),h=t(61594),f=t(87364),j=t(20853),p=t(21773),g=t(73239),w=t(38684),v=t(33473),N=t(75231),y=t(73312),b=t(25121),k=t(87081),A=t(22130),S=t(85534),C=t(61556),I=t(21567),E=t(75340),R=t(51055),T=t(60872),F=t(45686),q=t(93518),_=t(46967),O=t(33900);let B=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,I.cn)("w-full caption-bottom text-sm",t),...a})})});B.displayName="Table";let H=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("thead",{ref:s,className:(0,I.cn)("[&_tr]:border-b",t),...a})});H.displayName="TableHeader";let P=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,I.cn)("[&_tr:last-child]:border-0",t),...a})});P.displayName="TableBody",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,I.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let K=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tr",{ref:s,className:(0,I.cn)("border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});K.displayName="TableRow";let M=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("th",{ref:s,className:(0,I.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});M.displayName="TableHead";let Q=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("td",{ref:s,className:(0,I.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});Q.displayName="TableCell",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("caption",{ref:s,className:(0,I.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption";var D=t(57485);function $(e){let{items:s,isLoading:t,searchQuery:a,onSearchChange:l,page:n,totalPages:i,onPageChange:o,onEdit:d,onDelete:c}=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative max-w-sm",children:[(0,r.jsx)(j.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(O.p,{placeholder:"Search items...",value:a,onChange:e=>l(e.target.value),className:"pl-9"})]}),(0,r.jsx)("div",{className:"rounded-lg border border-border",children:(0,r.jsxs)(B,{children:[(0,r.jsx)(H,{children:(0,r.jsxs)(K,{children:[(0,r.jsx)(M,{className:"w-[30%]",children:"Question"}),(0,r.jsx)(M,{className:"w-[35%]",children:"Answer"}),(0,r.jsx)(M,{children:"Keywords"}),(0,r.jsx)(M,{children:"Source"}),(0,r.jsx)(M,{className:"w-[80px] text-center",children:"Embedding"}),(0,r.jsx)(M,{className:"w-[60px]"})]})}),(0,r.jsx)(P,{children:t?Array.from({length:5}).map((e,s)=>(0,r.jsxs)(K,{children:[(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"h-4 w-full"})}),(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"h-4 w-full"})}),(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"h-4 w-20"})}),(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"h-4 w-16"})}),(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"mx-auto h-4 w-4"})}),(0,r.jsx)(Q,{children:(0,r.jsx)(k.EA,{className:"h-8 w-8"})})]},s)):0===s.length?(0,r.jsx)(K,{children:(0,r.jsx)(Q,{colSpan:6,className:"h-32 text-center text-muted-foreground",children:a?"No items match your search.":"No items yet. Add your first item to get started."})}):s.map(e=>{var s;return(0,r.jsxs)(K,{children:[(0,r.jsx)(Q,{className:"font-medium",children:(0,I.xv)(e.question,60)}),(0,r.jsx)(Q,{className:"text-muted-foreground",children:(0,I.xv)(e.answer,80)}),(0,r.jsx)(Q,{children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[null===(s=e.keywords)||void 0===s?void 0:s.slice(0,3).map(e=>(0,r.jsx)(b.E,{variant:"secondary",className:"text-xs",children:e},e)),e.keywords&&e.keywords.length>3&&(0,r.jsxs)(b.E,{variant:"outline",className:"text-xs",children:["+",e.keywords.length-3]})]})}),(0,r.jsx)(Q,{className:"text-muted-foreground",children:e.source||"-"}),(0,r.jsx)(Q,{className:"text-center",children:e.has_embedding?(0,r.jsx)(g.A,{className:"mx-auto h-4 w-4 text-success"}):(0,r.jsx)(E.A,{className:"mx-auto h-4 w-4 text-muted-foreground"})}),(0,r.jsx)(Q,{children:(0,r.jsxs)(D.rI,{children:[(0,r.jsx)(D.ty,{asChild:!0,children:(0,r.jsx)(y.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(R.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(D.SQ,{align:"end",children:[(0,r.jsxs)(D._2,{onClick:()=>d(e),children:[(0,r.jsx)(T.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,r.jsxs)(D._2,{onClick:()=>c(e),className:"text-destructive",children:[(0,r.jsx)(F.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id)})})]})}),i>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Page ",n," of ",i]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(y.$,{variant:"outline",size:"sm",onClick:()=>o(n-1),disabled:n<=1,children:[(0,r.jsx)(q.A,{className:"h-4 w-4"}),"Previous"]}),(0,r.jsxs)(y.$,{variant:"outline",size:"sm",onClick:()=>o(n+1),disabled:n>=i,children:["Next",(0,r.jsx)(_.A,{className:"h-4 w-4"})]})]})]})]})}var V=t(69606),z=t(37177),L=t(4563),W=t(40767),J=t(51344),U=t(44870),Y=t(46754),G=t(65564);let Z=L.Ik({question:L.Yj().min(1,"Question is required").max(1e3,"Question must be 1000 characters or less"),answer:L.Yj().min(1,"Answer is required").max(1e4,"Answer must be 10000 characters or less"),source:L.Yj().max(200).optional()});function X(e){let{open:s,onOpenChange:t,knowledgeBaseId:l,item:n}=e,i=(0,o.jE)(),d=!!n,[m,u]=(0,a.useState)([]),[x,h]=(0,a.useState)(""),f=(0,V.mN)({resolver:(0,z.u)(Z),defaultValues:{question:"",answer:"",source:""}});(0,a.useEffect)(()=>{s&&(n?(f.reset({question:n.question,answer:n.answer,source:n.source||""}),u(n.keywords||[])):(f.reset({question:"",answer:"",source:""}),u([])),h(""))},[s,n,f]);let j=(0,c.n)({mutationFn:e=>S.FH.post("/knowledge-bases/".concat(l,"/items"),e),onSuccess:()=>{i.invalidateQueries({queryKey:C.lH.knowledgeItems.list(l,{})}),i.invalidateQueries({queryKey:C.lH.knowledgeBases.detail(l)}),(0,G.oR)({title:"Item created",description:"The item has been added to the knowledge base."}),t(!1)},onError:e=>{(0,G.oR)({title:"Error",description:e.message||"Failed to create item",variant:"error"})}}),p=(0,c.n)({mutationFn:e=>S.FH.put("/knowledge-bases/".concat(l,"/items/").concat(null==n?void 0:n.id),e),onSuccess:()=>{i.invalidateQueries({queryKey:C.lH.knowledgeItems.list(l,{})}),(0,G.oR)({title:"Item updated",description:"The item has been updated successfully."}),t(!1)},onError:e=>{(0,G.oR)({title:"Error",description:e.message||"Failed to update item",variant:"error"})}}),g=()=>{let e=x.trim().toLowerCase();e&&!m.includes(e)&&(u([...m,e]),h(""))},w=e=>{u(m.filter(s=>s!==e))},N=j.isPending||p.isPending;return(0,r.jsx)(J.lG,{open:s,onOpenChange:t,children:(0,r.jsxs)(J.Cf,{className:"sm:max-w-[600px]",children:[(0,r.jsxs)(J.c7,{children:[(0,r.jsx)(J.L3,{children:d?"Edit Item":"Add Item"}),(0,r.jsx)(J.rr,{children:d?"Update the question and answer for this knowledge item.":"Add a new question-answer pair to your knowledge base."})]}),(0,r.jsx)(U.lV,{...f,children:(0,r.jsxs)("form",{onSubmit:f.handleSubmit(e=>{let s={question:e.question,answer:e.answer,keywords:m.length>0?m:void 0,source:e.source||void 0};d?p.mutate(s):j.mutate(s)}),className:"space-y-4",children:[(0,r.jsx)(U.zB,{control:f.control,name:"question",render:e=>{let{field:s}=e;return(0,r.jsxs)(U.eI,{children:[(0,r.jsx)(U.lR,{children:"Question"}),(0,r.jsx)(U.MJ,{children:(0,r.jsx)(Y.T,{placeholder:"e.g., How do I reset my password?",className:"resize-none",rows:2,...s})}),(0,r.jsx)(U.C5,{})]})}}),(0,r.jsx)(U.zB,{control:f.control,name:"answer",render:e=>{let{field:s}=e;return(0,r.jsxs)(U.eI,{children:[(0,r.jsx)(U.lR,{children:"Answer"}),(0,r.jsx)(U.MJ,{children:(0,r.jsx)(Y.T,{placeholder:"Provide a detailed answer...",className:"resize-none",rows:4,...s})}),(0,r.jsx)(U.C5,{})]})}}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(U.lR,{children:"Keywords (optional)"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(O.p,{placeholder:"Add a keyword...",value:x,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),g())}}),(0,r.jsx)(y.$,{type:"button",variant:"outline",onClick:g,children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})]}),m.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:m.map(e=>(0,r.jsxs)(b.E,{variant:"secondary",className:"gap-1",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>w(e),className:"ml-1 hover:text-destructive",children:(0,r.jsx)(W.A,{className:"h-3 w-3"})})]},e))}),(0,r.jsx)(U.Rr,{children:"Keywords help with search relevance. Press Enter to add."})]}),(0,r.jsx)(U.zB,{control:f.control,name:"source",render:e=>{let{field:s}=e;return(0,r.jsxs)(U.eI,{children:[(0,r.jsx)(U.lR,{children:"Source (optional)"}),(0,r.jsx)(U.MJ,{children:(0,r.jsx)(O.p,{placeholder:"e.g., FAQ v1.0, Help Center",...s})}),(0,r.jsx)(U.Rr,{children:"Track where this information came from."}),(0,r.jsx)(U.C5,{})]})}}),(0,r.jsxs)(J.Es,{children:[(0,r.jsx)(y.$,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,r.jsx)(y.$,{type:"submit",disabled:N,children:N?"Saving...":d?"Save Changes":"Add Item"})]})]})})]})})}var ee=t(48152),es=t(49688),et=t(26760);let er=et.bL,ea=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(et.B8,{ref:s,className:(0,I.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});ea.displayName=et.B8.displayName;let el=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(et.l9,{ref:s,className:(0,I.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});el.displayName=et.l9.displayName;let en=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(et.UC,{ref:s,className:(0,I.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});en.displayName=et.UC.displayName;let ei=(0,t(31027).F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eo=a.forwardRef((e,s)=>{let{className:t,variant:a,...l}=e;return(0,r.jsx)("div",{ref:s,role:"alert",className:(0,I.cn)(ei({variant:a}),t),...l})});eo.displayName="Alert";let ed=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h5",{ref:s,className:(0,I.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})});ed.displayName="AlertTitle";let ec=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,I.cn)("text-sm [&_p]:leading-relaxed",t),...a})});function em(e){let{open:s,onOpenChange:t,knowledgeBaseId:l}=e,n=(0,o.jE)(),i=(0,a.useRef)(null),[d,m]=(0,a.useState)("json"),[u,x]=(0,a.useState)(""),[f,j]=(0,a.useState)(""),[p,v]=(0,a.useState)([]),[N,b]=(0,a.useState)([]),k=(0,c.n)({mutationFn:e=>S.FH.post("/knowledge-bases/".concat(l,"/items/bulk"),{items:e}),onSuccess:e=>{var s,t;n.invalidateQueries({queryKey:C.lH.knowledgeItems.list(l,{})}),n.invalidateQueries({queryKey:C.lH.knowledgeBases.detail(l)}),(0,G.oR)({title:"Import completed",description:"Successfully imported ".concat(e.created," items.").concat((null===(s=e.errors)||void 0===s?void 0:s.length)>0?" ".concat(e.errors.length," errors."):"")}),(null===(t=e.errors)||void 0===t?void 0:t.length)>0?v(e.errors):A()},onError:e=>{(0,G.oR)({title:"Import failed",description:e.message||"Failed to import items",variant:"error"})}}),A=()=>{x(""),j(""),v([]),b([]),t(!1)},I=e=>{try{let s=JSON.parse(e),t=s.items||s;if(!Array.isArray(t))throw Error("Expected an array of items");let r=[],a=[];return t.forEach((e,s)=>{if(!e.question||!e.answer){a.push("Item ".concat(s+1,": Missing question or answer"));return}r.push({question:String(e.question),answer:String(e.answer),keywords:Array.isArray(e.keywords)?e.keywords.map(String):void 0,source:e.source?String(e.source):void 0})}),a.length>0&&v(a),r}catch(e){return v([e.message||"Invalid JSON format"]),null}},E=e=>{try{let s=e.split("\n").filter(e=>e.trim());if(s.length<2)throw Error("CSV must have at least a header row and one data row");let t=s[0].split(",").map(e=>e.trim().toLowerCase()),r=t.indexOf("question"),a=t.indexOf("answer"),l=t.indexOf("keywords"),n=t.indexOf("source");if(-1===r||-1===a)throw Error('CSV must have "question" and "answer" columns');let i=[],o=[];for(let e=1;e<s.length;e++){let t=R(s[e]);if(!t[r]||!t[a]){o.push("Row ".concat(e+1,": Missing question or answer"));continue}i.push({question:t[r],answer:t[a],keywords:l>=0&&t[l]?t[l].split(";").map(e=>e.trim()).filter(Boolean):void 0,source:n>=0?t[n]:void 0})}return o.length>0&&v(o),i}catch(e){return v([e.message||"Invalid CSV format"]),null}},R=e=>{let s=[],t="",r=!1;for(let a=0;a<e.length;a++){let l=e[a];'"'===l&&(0===a||"\\"!==e[a-1])?r=!r:","!==l||r?t+=l:(s.push(t.trim()),t="")}return s.push(t.trim()),s},T=()=>{v([]),b([]);let e="json"===d?u:f;if(!e.trim()){v(["Please enter some data to import"]);return}let s="json"===d?I(e):E(e);s&&s.length>0&&b(s)};return(0,r.jsx)(J.lG,{open:s,onOpenChange:A,children:(0,r.jsxs)(J.Cf,{className:"sm:max-w-[700px]",children:[(0,r.jsxs)(J.c7,{children:[(0,r.jsx)(J.L3,{children:"Bulk Import"}),(0,r.jsx)(J.rr,{children:"Import multiple items at once using JSON or CSV format."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("input",{ref:i,type:"file",accept:".json,.csv",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;let r=new FileReader;r.onload=e=>{var s;let r=null===(s=e.target)||void 0===s?void 0:s.result;t.name.endsWith(".json")?(m("json"),x(r)):t.name.endsWith(".csv")&&(m("csv"),j(r)),v([]),b([])},r.readAsText(t),i.current&&(i.current.value="")},className:"hidden"}),(0,r.jsxs)(y.$,{variant:"outline",onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.click()},children:[(0,r.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Upload File"]}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Supports .json and .csv files"})]}),(0,r.jsxs)(er,{value:d,onValueChange:e=>m(e),children:[(0,r.jsxs)(ea,{className:"grid w-full grid-cols-2",children:[(0,r.jsxs)(el,{value:"json",className:"flex items-center gap-2",children:[(0,r.jsx)(ee.A,{className:"h-4 w-4"}),"JSON"]}),(0,r.jsxs)(el,{value:"csv",className:"flex items-center gap-2",children:[(0,r.jsx)(es.A,{className:"h-4 w-4"}),"CSV"]})]}),(0,r.jsx)(en,{value:"json",className:"space-y-2",children:(0,r.jsx)(Y.T,{placeholder:'{\n  "items": [\n    {\n      "question": "How do I reset my password?",\n      "answer": "Go to Settings > Security > Reset Password",\n      "keywords": ["password", "reset", "security"],\n      "source": "FAQ v1.0"\n    }\n  ]\n}',value:u,onChange:e=>{x(e.target.value),b([]),v([])},className:"font-mono text-sm min-h-[200px]"})}),(0,r.jsxs)(en,{value:"csv",className:"space-y-2",children:[(0,r.jsx)(Y.T,{placeholder:'question,answer,keywords,source\n"How do I reset my password?","Go to Settings > Security > Reset Password","password;reset;security","FAQ v1.0"\n"What are your hours?","We\'re open 9am-5pm Monday to Friday","hours;schedule;availability","FAQ v1.0"',value:f,onChange:e=>{j(e.target.value),b([]),v([])},className:"font-mono text-sm min-h-[200px]"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Use semicolons (;) to separate multiple keywords within the keywords column."})]})]}),p.length>0&&(0,r.jsxs)(eo,{variant:"destructive",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),(0,r.jsx)(ed,{children:"Errors"}),(0,r.jsx)(ec,{children:(0,r.jsxs)("ul",{className:"list-disc list-inside text-sm",children:[p.slice(0,5).map((e,s)=>(0,r.jsx)("li",{children:e},s)),p.length>5&&(0,r.jsxs)("li",{children:["...and ",p.length-5," more errors"]})]})})]}),N.length>0&&0===p.length&&(0,r.jsxs)(eo,{children:[(0,r.jsx)(g.A,{className:"h-4 w-4"}),(0,r.jsx)(ed,{children:"Ready to Import"}),(0,r.jsxs)(ec,{children:[N.length," item",N.length>1?"s":""," parsed successfully."]})]})]}),(0,r.jsxs)(J.Es,{children:[(0,r.jsx)(y.$,{variant:"outline",onClick:A,children:"Cancel"}),(0,r.jsx)(y.$,{variant:"outline",onClick:T,disabled:!(u.trim()||f.trim()),children:"Validate"}),(0,r.jsx)(y.$,{onClick:()=>{if(0===N.length){T();return}if(N.length>100){v(["Maximum 100 items per import. Please split your data."]);return}k.mutate(N)},disabled:k.isPending||0===N.length&&p.length>0,children:k.isPending?"Importing...":N.length>0?"Import ".concat(N.length," Items"):"Parse & Import"})]})]})})}ec.displayName="AlertDescription";let eu={faq:m.A,documents:u.A,website:x.A},ex={active:"success",syncing:"warning",error:"error"};function eh(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),t=(0,o.jE)(),n=e.id,[u,x]=(0,a.useState)(!1),[E,R]=(0,a.useState)(null),[T,F]=(0,a.useState)(!1),[q,_]=(0,a.useState)(1),[O,B]=(0,a.useState)(""),{data:H,isLoading:P}=(0,d.I)({queryKey:C.lH.knowledgeBases.detail(n),queryFn:()=>S.FH.get("/knowledge-bases/".concat(n))}),{data:K,isLoading:M}=(0,d.I)({queryKey:C.lH.knowledgeItems.list(n,{page:q,search:O}),queryFn:()=>S.FH.get("/knowledge-bases/".concat(n,"/items"),{page:String(q),page_size:"20",...O&&{search:O}})}),Q=(0,c.n)({mutationFn:()=>S.FH.post("/knowledge-bases/".concat(n,"/regenerate-embeddings")),onSuccess:()=>{t.invalidateQueries({queryKey:C.lH.knowledgeBases.detail(n)})}}),D=(0,c.n)({mutationFn:e=>S.FH.delete("/knowledge-bases/".concat(n,"/items/").concat(e)),onSuccess:()=>{t.invalidateQueries({queryKey:C.lH.knowledgeItems.list(n,{})}),t.invalidateQueries({queryKey:C.lH.knowledgeBases.detail(n)})}}),V=(null==K?void 0:K.data)||[],z=Math.ceil(((null==K?void 0:K.total)||0)/20),L=H?eu[H.type]:m.A,W=V.filter(e=>e.has_embedding).length,J=async e=>{confirm("Are you sure you want to delete this item?")&&await D.mutateAsync(e.id)};return P?(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(N.Y,{title:"Knowledge Base"}),(0,r.jsxs)("div",{className:"flex-1 p-6",children:[(0,r.jsx)(k.EA,{className:"mb-4 h-8 w-64"}),(0,r.jsx)(k.EA,{className:"mb-6 h-24 w-full"}),(0,r.jsx)(k.EA,{className:"h-96 w-full"})]})]}):H?(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(N.Y,{title:"Knowledge Base"}),(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)(i(),{href:"/knowledge-base",className:"mb-2 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(f.A,{className:"mr-1 h-4 w-4"}),"Back to Knowledge Bases"]}),(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:(0,r.jsx)(L,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:H.name}),(0,r.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,r.jsx)(b.E,{variant:"secondary",children:H.type.toUpperCase()}),(0,r.jsx)(b.E,{variant:ex[H.status],children:H.status})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(y.$,{variant:"outline",asChild:!0,children:(0,r.jsxs)(i(),{href:"/knowledge-base/".concat(n,"/search"),children:[(0,r.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Test Search"]})}),(0,r.jsxs)(y.$,{variant:"outline",onClick:()=>Q.mutate(),disabled:Q.isPending,children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4 ".concat(Q.isPending?"animate-spin":"")}),"Regenerate Embeddings"]})]})]}),H.description&&(0,r.jsx)("p",{className:"mt-4 text-muted-foreground",children:H.description})]}),(0,r.jsxs)("div",{className:"mb-6 grid gap-4 md:grid-cols-4",children:[(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Items"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:H.item_count})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"With Embeddings"}),(0,r.jsxs)("p",{className:"text-2xl font-bold flex items-center gap-2",children:[W,W===V.length&&V.length>0&&(0,r.jsx)(g.A,{className:"h-5 w-5 text-success"})]})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Last Synced"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:H.last_sync_at?(0,I.mo)(H.last_sync_at):"Never"})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:(0,I.mo)(H.created_at)})]})})]}),(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Items"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(y.$,{variant:"outline",onClick:()=>F(!0),children:[(0,r.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Bulk Import"]}),(0,r.jsxs)(y.$,{onClick:()=>x(!0),children:[(0,r.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Add Item"]})]})]}),(0,r.jsx)($,{items:V,isLoading:M,searchQuery:O,onSearchChange:B,page:q,totalPages:z,onPageChange:_,onEdit:e=>{R(e),x(!0)},onDelete:J})]}),(0,r.jsx)(X,{open:u,onOpenChange:()=>{x(!1),R(null)},knowledgeBaseId:n,item:E}),(0,r.jsx)(em,{open:T,onOpenChange:F,knowledgeBaseId:n})]}):(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(N.Y,{title:"Knowledge Base"}),(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(h.A,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h2",{className:"mb-2 text-lg font-medium",children:"Knowledge base not found"}),(0,r.jsx)("p",{className:"mb-4 text-sm text-muted-foreground",children:"The knowledge base you're looking for doesn't exist."}),(0,r.jsxs)(y.$,{onClick:()=>s.push("/knowledge-base"),children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Back to Knowledge Bases"]})]})})]})}},44870:(e,s,t)=>{"use strict";t.d(s,{C5:()=>g,MJ:()=>j,Rr:()=>p,eI:()=>h,lR:()=>f,lV:()=>d,zB:()=>m});var r=t(95155),a=t(12115),l=t(12317),n=t(69606),i=t(21567),o=t(98986);let d=n.Op,c=a.createContext({}),m=e=>{let{...s}=e;return(0,r.jsx)(c.Provider,{value:{name:s.name},children:(0,r.jsx)(n.xI,{...s})})},u=()=>{let e=a.useContext(c),s=a.useContext(x),{getFieldState:t,formState:r}=(0,n.xW)(),l=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...l}},x=a.createContext({}),h=a.forwardRef((e,s)=>{let{className:t,...l}=e,n=a.useId();return(0,r.jsx)(x.Provider,{value:{id:n},children:(0,r.jsx)("div",{ref:s,className:(0,i.cn)("space-y-2",t),...l})})});h.displayName="FormItem";let f=a.forwardRef((e,s)=>{let{className:t,...a}=e,{error:l,formItemId:n}=u();return(0,r.jsx)(o.J,{ref:s,className:(0,i.cn)(l&&"text-destructive",t),htmlFor:n,...a})});f.displayName="FormLabel";let j=a.forwardRef((e,s)=>{let{...t}=e,{error:a,formItemId:n,formDescriptionId:i,formMessageId:o}=u();return(0,r.jsx)(l.DX,{ref:s,id:n,"aria-describedby":a?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!a,...t})});j.displayName="FormControl";let p=a.forwardRef((e,s)=>{let{className:t,...a}=e,{formDescriptionId:l}=u();return(0,r.jsx)("p",{ref:s,id:l,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});p.displayName="FormDescription";let g=a.forwardRef((e,s)=>{let{className:t,children:a,...l}=e,{error:n,formMessageId:o}=u(),d=n?String(null==n?void 0:n.message):a;return d?(0,r.jsx)("p",{ref:s,id:o,className:(0,i.cn)("text-sm font-medium text-destructive",t),...l,children:d}):null});g.displayName="FormMessage"},65564:(e,s,t)=>{"use strict";t.d(s,{Kf:()=>x,dj:()=>u,oR:()=>m});var r=t(12115);let a=0,l=new Map,n=e=>{if(l.has(e))return;let s=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},5e3);l.set(e,s)},i=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function m(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=r.useState(d);return r.useEffect(()=>(o.push(s),()=>{let e=o.indexOf(s);e>-1&&o.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}let x=(e,s)=>m({title:e,description:s,variant:"error"})}},e=>{var s=s=>e(e.s=s);e.O(0,[2361,8233,7778,6299,9556,3454,7866,6987,8173,384,6622,3832,4580,1306,8441,1517,7358],()=>s(64064)),_N_E=e.O()}]);