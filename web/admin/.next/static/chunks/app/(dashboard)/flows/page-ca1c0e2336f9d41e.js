(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1384],{28411:(e,s,a)=>{Promise.resolve().then(a.bind(a,90258))},87694:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},14505:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},63348:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},22725:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},29191:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},6118:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]])},67072:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(67401).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},76046:(e,s,a)=>{"use strict";var t=a(66658);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},90258:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>J});var t=a(95155),l=a(12115),r=a(35906),i=a(39556),n=a(25848),d=a(20853),c=a(33473),o=a(87694),m=a(76046),u=a(75231),h=a(73312),x=a(33900),g=a(87081),p=a(37528),f=a(85534),j=a(61556),v=a(63348),y=a(67401);let w=(0,y.A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var N=a(67072);let b=(0,y.A)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);var k=a(51055);let A=(0,y.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var C=a(6118),S=a(22725),M=a(29191),P=a(45686),T=a(22130),F=a(25121),_=a(57485);let q={welcome:(0,t.jsx)(v.A,{className:"h-4 w-4"}),keyword:(0,t.jsx)(w,{className:"h-4 w-4"}),intent:(0,t.jsx)(N.A,{className:"h-4 w-4"}),manual:(0,t.jsx)(b,{className:"h-4 w-4"})},E={welcome:"Welcome Message",keyword:"Keyword Trigger",intent:"Intent Match",manual:"Manual Trigger"};function z(e){var s;let{flow:a,onEdit:l,onToggleActive:r,onDelete:i,onTest:n,isToggling:d}=e,c=(null===(s=a.nodes)||void 0===s?void 0:s.length)||0;return(0,t.jsxs)(T.Zp,{className:"group relative hover:shadow-md transition-shadow",children:[(0,t.jsx)(T.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"rounded-lg p-2 ".concat(a.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"),children:(0,t.jsx)(o.A,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(T.ZB,{className:"text-base font-medium",children:a.name}),a.description&&(0,t.jsx)(T.BT,{className:"text-sm line-clamp-1",children:a.description})]})]}),(0,t.jsxs)(_.rI,{children:[(0,t.jsx)(_.ty,{asChild:!0,children:(0,t.jsx)(h.$,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100",children:(0,t.jsx)(k.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(_.SQ,{align:"end",children:[(0,t.jsxs)(_._2,{onClick:l,children:[(0,t.jsx)(A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,t.jsxs)(_._2,{onClick:n,children:[(0,t.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Test"]}),(0,t.jsx)(_._2,{onClick:r,disabled:d,children:a.is_active?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.A,{className:"mr-2 h-4 w-4"}),"Activate"]})}),(0,t.jsx)(_.mB,{}),(0,t.jsxs)(_._2,{onClick:i,className:"text-destructive",children:[(0,t.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),(0,t.jsxs)(T.Wu,{children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,t.jsxs)(F.E,{variant:"secondary",className:"gap-1",children:[q[a.trigger],E[a.trigger]]}),a.trigger_value&&(0,t.jsx)(F.E,{variant:"outline",className:"font-mono text-xs",children:a.trigger_value}),(0,t.jsxs)(F.E,{variant:"outline",children:[c," ",1===c?"node":"nodes"]}),(0,t.jsx)(F.E,{variant:a.is_active?"default":"secondary",className:"ml-auto",children:a.is_active?"Active":"Inactive"})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsxs)(h.$,{variant:"outline",size:"sm",className:"flex-1",onClick:l,children:[(0,t.jsx)(A,{className:"mr-2 h-3 w-3"}),"Edit"]}),(0,t.jsxs)(h.$,{variant:"outline",size:"sm",className:"flex-1",onClick:n,children:[(0,t.jsx)(C.A,{className:"mr-2 h-3 w-3"}),"Test"]})]})]})]})}var H=a(14505),R=a(51344),I=a(98986),V=a(46754);let K=[{value:"welcome",label:"Welcome Message",description:"Triggered when a new conversation starts"},{value:"keyword",label:"Keyword",description:"Triggered when a specific keyword is detected"},{value:"intent",label:"Intent",description:"Triggered when an intent is recognized by AI"},{value:"manual",label:"Manual",description:"Triggered manually by agents or other flows"}];function $(e){let{open:s,onOpenChange:a}=e,i=(0,m.useRouter)(),d=(0,r.jE)(),[c,o]=(0,l.useState)(""),[u,g]=(0,l.useState)(""),[v,y]=(0,l.useState)("keyword"),[w,N]=(0,l.useState)(""),b=(0,n.n)({mutationFn:e=>f.FH.post("/flows",e),onSuccess:e=>{d.invalidateQueries({queryKey:j.lH.flows.all}),a(!1),i.push("/flows/".concat(e.id))}}),k=()=>{o(""),g(""),y("keyword"),N("")},A=e=>{e||k(),a(e)},C="keyword"===v||"intent"===v;return(0,t.jsx)(R.lG,{open:s,onOpenChange:A,children:(0,t.jsx)(R.Cf,{className:"sm:max-w-[500px]",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s="start";b.mutate({name:c,description:u||void 0,trigger:v,trigger_value:w||void 0,start_node_id:s,nodes:[{id:s,type:"message",content:"Hello! How can I help you today?",transitions:[],position:{x:250,y:50}}]})},children:[(0,t.jsxs)(R.c7,{children:[(0,t.jsx)(R.L3,{children:"Create New Flow"}),(0,t.jsx)(R.rr,{children:"Create a conversational flow to guide customers through a decision tree."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(I.J,{htmlFor:"name",children:"Name"}),(0,t.jsx)(x.p,{id:"name",placeholder:"e.g., Support Ticket Flow",value:c,onChange:e=>o(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(I.J,{htmlFor:"description",children:"Description (optional)"}),(0,t.jsx)(V.T,{id:"description",placeholder:"Describe what this flow does...",value:u,onChange:e=>g(e.target.value),rows:2})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(I.J,{htmlFor:"trigger",children:"Trigger"}),(0,t.jsxs)(p.l6,{value:v,onValueChange:e=>y(e),children:[(0,t.jsx)(p.bq,{children:(0,t.jsx)(p.yv,{})}),(0,t.jsx)(p.gC,{children:K.map(e=>(0,t.jsx)(p.eb,{value:e.value,children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]})},e.value))})]})]}),C&&(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(I.J,{htmlFor:"triggerValue",children:"keyword"===v?"Keyword":"Intent Name"}),(0,t.jsx)(x.p,{id:"triggerValue",placeholder:"keyword"===v?"e.g., support, help":"e.g., request_support",value:w,onChange:e=>N(e.target.value)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"keyword"===v?"The keyword that will trigger this flow (case-insensitive)":"The intent name that will trigger this flow"})]})]}),(0,t.jsxs)(R.Es,{children:[(0,t.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,t.jsxs)(h.$,{type:"submit",disabled:!c||b.isPending,children:[b.isPending&&(0,t.jsx)(H.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create & Edit"]})]})]})})})}function J(){let e=(0,m.useRouter)(),[s,a]=(0,l.useState)(""),[v,y]=(0,l.useState)("all"),[w,N]=(0,l.useState)("all"),[b,k]=(0,l.useState)(!1),A=(0,r.jE)(),{data:C,isLoading:S}=(0,i.I)({queryKey:j.lH.flows.list({search:s,trigger:v,status:w}),queryFn:()=>f.FH.get("/flows",{...s&&{search:s},..."all"!==v&&{trigger:v},..."all"!==w&&{is_active:"active"===w?"true":"false"}})}),M=(0,n.n)({mutationFn:e=>f.FH.post("/flows/".concat(e,"/activate")),onSuccess:()=>{A.invalidateQueries({queryKey:j.lH.flows.all})}}),P=(0,n.n)({mutationFn:e=>f.FH.post("/flows/".concat(e,"/deactivate")),onSuccess:()=>{A.invalidateQueries({queryKey:j.lH.flows.all})}}),T=(0,n.n)({mutationFn:e=>f.FH.delete("/flows/".concat(e)),onSuccess:()=>{A.invalidateQueries({queryKey:j.lH.flows.all})}}),F=(null==C?void 0:C.data)||[],_=s=>{e.push("/flows/".concat(s.id))},q=async e=>{e.is_active?await P.mutateAsync(e.id):await M.mutateAsync(e.id)},E=async e=>{confirm('Are you sure you want to delete "'.concat(e.name,'"?'))&&await T.mutateAsync(e.id)},H=s=>{e.push("/flows/".concat(s.id,"?test=true"))};return(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsx)(u.Y,{title:"Conversational Flows"}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,t.jsxs)("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative max-w-sm flex-1",children:[(0,t.jsx)(d.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(x.p,{placeholder:"Search flows...",value:s,onChange:e=>a(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(p.l6,{value:v,onValueChange:e=>y(e),children:[(0,t.jsx)(p.bq,{className:"w-[140px]",children:(0,t.jsx)(p.yv,{placeholder:"Trigger"})}),(0,t.jsxs)(p.gC,{children:[(0,t.jsx)(p.eb,{value:"all",children:"All Triggers"}),(0,t.jsx)(p.eb,{value:"welcome",children:"Welcome"}),(0,t.jsx)(p.eb,{value:"keyword",children:"Keyword"}),(0,t.jsx)(p.eb,{value:"intent",children:"Intent"}),(0,t.jsx)(p.eb,{value:"manual",children:"Manual"})]})]}),(0,t.jsxs)(p.l6,{value:w,onValueChange:e=>N(e),children:[(0,t.jsx)(p.bq,{className:"w-[140px]",children:(0,t.jsx)(p.yv,{placeholder:"Status"})}),(0,t.jsxs)(p.gC,{children:[(0,t.jsx)(p.eb,{value:"all",children:"All Status"}),(0,t.jsx)(p.eb,{value:"active",children:"Active"}),(0,t.jsx)(p.eb,{value:"inactive",children:"Inactive"})]})]})]}),(0,t.jsxs)(h.$,{onClick:()=>k(!0),children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"New Flow"]})]}),S?(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,s)=>(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card p-4",children:[(0,t.jsx)(g.EA,{className:"mb-4 h-10 w-10 rounded-lg"}),(0,t.jsx)(g.EA,{className:"mb-2 h-5 w-3/4"}),(0,t.jsx)(g.EA,{className:"mb-4 h-4 w-full"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(g.EA,{className:"h-5 w-16"}),(0,t.jsx)(g.EA,{className:"h-5 w-20"})]})]},s))}):0===F.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)(o.A,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground/50"}),(0,t.jsx)("h3",{className:"mb-2 text-lg font-medium",children:"No flows yet"}),(0,t.jsx)("p",{className:"mb-4 text-sm text-muted-foreground",children:"Create conversational flows to guide your customers through decision trees."}),(0,t.jsxs)(h.$,{onClick:()=>k(!0),children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Create Flow"]})]}):(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:F.map(e=>(0,t.jsx)(z,{flow:e,onEdit:()=>_(e),onToggleActive:()=>q(e),onDelete:()=>E(e),onTest:()=>H(e),isToggling:M.isPending&&M.variables===e.id||P.isPending&&P.variables===e.id},e.id))})]}),(0,t.jsx)($,{open:b,onOpenChange:k})]})}},37528:(e,s,a)=>{"use strict";a.d(s,{bq:()=>u,eb:()=>p,gC:()=>g,l6:()=>o,yv:()=>m});var t=a(95155),l=a(12115),r=a(58012),i=a(51719),n=a(91902),d=a(98867),c=a(21567);let o=r.bL;r.YJ;let m=r.WT,u=l.forwardRef((e,s)=>{let{className:a,children:l,...n}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[l,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=r.l9.displayName;let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=r.PP.displayName;let x=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=r.wn.displayName;let g=l.forwardRef((e,s)=>{let{className:a,children:l,position:i="popper",...n}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-card text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,t.jsx)(h,{}),(0,t.jsx)(r.LM,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(x,{})]})})});g.displayName=r.UC.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=r.JU.displayName;let p=l.forwardRef((e,s)=>{let{className:a,children:l,...i}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:l})]})});p.displayName=r.q7.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=r.wv.displayName},61786:(e,s,a)=>{"use strict";function t(e,[s,a]){return Math.min(a,Math.max(s,e))}a.d(s,{q:()=>t})},23360:(e,s,a)=>{"use strict";a.d(s,{sG:()=>i});var t=a(12115);a(47650);var l=a(12317),r=a(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let a=(0,l.TL)(`Primitive.${s}`),i=t.forwardRef((e,t)=>{let{asChild:l,...i}=e,n=l?a:s;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(n,{...i,ref:t})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{})}},e=>{var s=s=>e(e.s=s);e.O(0,[2361,8233,7778,6299,9556,3454,7866,6987,384,6393,4580,1306,8441,1517,7358],()=>s(28411)),_N_E=e.O()}]);