(()=>{var e={};e.id=357,e.ids=[357],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},37467:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o});var t=r(70260),a=r(28203),n=r(25155),l=r.n(n),i=r(67292),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(s,d);let o=["",{children:["(dashboard)",{children:["knowledge-base",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,76534)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58426)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,71354)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(dashboard)/knowledge-base/page",pathname:"/knowledge-base",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},20762:(e,s,r)=>{Promise.resolve().then(r.bind(r,76534))},89218:(e,s,r)=>{Promise.resolve().then(r.bind(r,89919))},89919:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>H});var t=r(45512),a=r(58009),n=r(64186),l=r(33115),i=r(30191),d=r(16873),o=r(18741),c=r(4269),m=r(37239),x=r(39400),u=r(77722),p=r(97093),h=r(93732),f=r(69586),j=r(63146),g=r(28531),b=r.n(g),w=r(61075),v=r(74464),y=r(17033),N=r(3736),k=r(92557),C=r(49656),A=r(64590),P=r(78447),R=r(35223),q=r(44195);let F={faq:c.A,documents:w.A,website:v.A},_={faq:"FAQ",documents:"Documents",website:"Website"},E={active:"success",syncing:"warning",error:"error"};function S({knowledgeBase:e,onEdit:s,onDelete:r,onRegenerate:a,isRegenerating:n}){let l=F[e.type]||c.A;return(0,t.jsxs)(A.Zp,{className:"group transition-colors hover:border-primary/30",children:[(0,t.jsx)(A.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsx)(l,{className:"h-5 w-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b(),{href:`/knowledge-base/${e.id}`,className:"font-medium hover:text-primary hover:underline",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(P.E,{variant:"secondary",className:"text-xs",children:_[e.type]}),(0,t.jsx)(P.E,{variant:E[e.status],className:"text-xs",children:e.status})]})]})]}),(0,t.jsxs)(R.rI,{children:[(0,t.jsx)(R.ty,{asChild:!0,children:(0,t.jsx)(x.$,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100",children:(0,t.jsx)(y.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(R.SQ,{align:"end",children:[(0,t.jsx)(R._2,{asChild:!0,children:(0,t.jsxs)(b(),{href:`/knowledge-base/${e.id}`,children:[(0,t.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"View Items"]})}),(0,t.jsx)(R._2,{asChild:!0,children:(0,t.jsxs)(b(),{href:`/knowledge-base/${e.id}/search`,children:[(0,t.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Test Search"]})}),(0,t.jsx)(R.mB,{}),(0,t.jsxs)(R._2,{onClick:s,children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,t.jsxs)(R._2,{onClick:a,disabled:n,children:[(0,t.jsx)(k.A,{className:`mr-2 h-4 w-4 ${n?"animate-spin":""}`}),"Regenerate Embeddings"]}),(0,t.jsx)(R.mB,{}),(0,t.jsxs)(R._2,{onClick:r,className:"text-destructive",children:[(0,t.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),(0,t.jsxs)(A.Wu,{children:[e.description&&(0,t.jsx)("p",{className:"mb-3 text-sm text-muted-foreground line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,t.jsxs)("span",{children:[e.item_count," items"]}),e.last_sync_at?(0,t.jsxs)("span",{children:["Synced ",(0,q.mo)(e.last_sync_at)]}):(0,t.jsx)("span",{children:"Never synced"})]})]})]})}var I=r(6868),$=r(19462),B=r(45009),z=r(43264),K=r(99926),D=r(75002),M=r(54716);let Q=B.Ik({name:B.Yj().min(1,"Name is required").max(100,"Name must be 100 characters or less"),description:B.Yj().max(500,"Description must be 500 characters or less").optional(),type:B.k5(["faq","documents","website"],{required_error:"Please select a type"})});function U({open:e,onOpenChange:s,knowledgeBase:r}){let a=(0,n.jE)(),l=!!r,d=(0,I.mN)({resolver:(0,$.u)(Q),defaultValues:{name:"",description:"",type:"faq"}}),o=(0,i.n)({mutationFn:e=>f.FH.post("/knowledge-bases",e),onSuccess:()=>{a.invalidateQueries({queryKey:j.lH.knowledgeBases.all}),(0,M.oR)({title:"Knowledge base created",description:"Your knowledge base has been created successfully."}),s(!1)},onError:e=>{(0,M.oR)({title:"Error",description:e.message||"Failed to create knowledge base",variant:"error"})}}),c=(0,i.n)({mutationFn:e=>f.FH.put(`/knowledge-bases/${r?.id}`,e),onSuccess:()=>{a.invalidateQueries({queryKey:j.lH.knowledgeBases.all}),(0,M.oR)({title:"Knowledge base updated",description:"Your knowledge base has been updated successfully."}),s(!1)},onError:e=>{(0,M.oR)({title:"Error",description:e.message||"Failed to update knowledge base",variant:"error"})}}),m=o.isPending||c.isPending;return(0,t.jsx)(z.lG,{open:e,onOpenChange:s,children:(0,t.jsxs)(z.Cf,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(z.c7,{children:[(0,t.jsx)(z.L3,{children:l?"Edit Knowledge Base":"Create Knowledge Base"}),(0,t.jsx)(z.rr,{children:l?"Update the details of your knowledge base.":"Create a new knowledge base to store FAQs, documents, or website content for AI-powered responses."})]}),(0,t.jsx)(K.lV,{...d,children:(0,t.jsxs)("form",{onSubmit:d.handleSubmit(e=>{l?c.mutate({name:e.name,description:e.description}):o.mutate({name:e.name,description:e.description,type:e.type})}),className:"space-y-4",children:[(0,t.jsx)(K.zB,{control:d.control,name:"name",render:({field:e})=>(0,t.jsxs)(K.eI,{children:[(0,t.jsx)(K.lR,{children:"Name"}),(0,t.jsx)(K.MJ,{children:(0,t.jsx)(u.p,{placeholder:"e.g., Product FAQ",...e})}),(0,t.jsx)(K.C5,{})]})}),(0,t.jsx)(K.zB,{control:d.control,name:"description",render:({field:e})=>(0,t.jsxs)(K.eI,{children:[(0,t.jsx)(K.lR,{children:"Description"}),(0,t.jsx)(K.MJ,{children:(0,t.jsx)(D.T,{placeholder:"Describe what this knowledge base contains...",className:"resize-none",rows:3,...e})}),(0,t.jsx)(K.Rr,{children:"A brief description to help identify this knowledge base."}),(0,t.jsx)(K.C5,{})]})}),(0,t.jsx)(K.zB,{control:d.control,name:"type",render:({field:e})=>(0,t.jsxs)(K.eI,{children:[(0,t.jsx)(K.lR,{children:"Type"}),(0,t.jsxs)(h.l6,{onValueChange:e.onChange,defaultValue:e.value,disabled:l,children:[(0,t.jsx)(K.MJ,{children:(0,t.jsx)(h.bq,{children:(0,t.jsx)(h.yv,{placeholder:"Select a type"})})}),(0,t.jsxs)(h.gC,{children:[(0,t.jsx)(h.eb,{value:"faq",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"FAQ"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Question and answer pairs"})]})}),(0,t.jsx)(h.eb,{value:"documents",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"Documents"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"PDF, Word, or text documents"})]})}),(0,t.jsx)(h.eb,{value:"website",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{children:"Website"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Crawled website content"})]})})]})]}),l&&(0,t.jsx)(K.Rr,{children:"Type cannot be changed after creation."}),(0,t.jsx)(K.C5,{})]})}),(0,t.jsxs)(z.Es,{children:[(0,t.jsx)(x.$,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,t.jsx)(x.$,{type:"submit",disabled:m,children:m?"Saving...":l?"Save Changes":"Create"})]})]})})]})})}function H(){let[e,s]=(0,a.useState)(""),[r,g]=(0,a.useState)("all"),[b,w]=(0,a.useState)("all"),[v,y]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),C=(0,n.jE)(),{data:A,isLoading:P}=(0,l.I)({queryKey:j.lH.knowledgeBases.list({search:e,type:r,status:b}),queryFn:()=>f.FH.get("/knowledge-bases",{...e&&{search:e},..."all"!==r&&{type:r},..."all"!==b&&{status:b}})}),R=(0,i.n)({mutationFn:e=>f.FH.delete(`/knowledge-bases/${e}`),onSuccess:()=>{C.invalidateQueries({queryKey:j.lH.knowledgeBases.all})}}),q=(0,i.n)({mutationFn:e=>f.FH.post(`/knowledge-bases/${e}/regenerate-embeddings`),onSuccess:()=>{C.invalidateQueries({queryKey:j.lH.knowledgeBases.all})}}),F=A?.data||[],_=e=>{k(e),y(!0)},E=async e=>{confirm(`Are you sure you want to delete "${e.name}"? This will also delete all items in this knowledge base.`)&&await R.mutateAsync(e.id)},I=async e=>{await q.mutateAsync(e.id)};return(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsx)(m.Y,{title:"Knowledge Base"}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,t.jsxs)("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-1 items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative max-w-sm flex-1",children:[(0,t.jsx)(d.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(u.p,{placeholder:"Search knowledge bases...",value:e,onChange:e=>s(e.target.value),className:"pl-9"})]}),(0,t.jsxs)(h.l6,{value:r,onValueChange:e=>g(e),children:[(0,t.jsx)(h.bq,{className:"w-[140px]",children:(0,t.jsx)(h.yv,{placeholder:"Type"})}),(0,t.jsxs)(h.gC,{children:[(0,t.jsx)(h.eb,{value:"all",children:"All Types"}),(0,t.jsx)(h.eb,{value:"faq",children:"FAQ"}),(0,t.jsx)(h.eb,{value:"documents",children:"Documents"}),(0,t.jsx)(h.eb,{value:"website",children:"Website"})]})]}),(0,t.jsxs)(h.l6,{value:b,onValueChange:e=>w(e),children:[(0,t.jsx)(h.bq,{className:"w-[140px]",children:(0,t.jsx)(h.yv,{placeholder:"Status"})}),(0,t.jsxs)(h.gC,{children:[(0,t.jsx)(h.eb,{value:"all",children:"All Status"}),(0,t.jsx)(h.eb,{value:"active",children:"Active"}),(0,t.jsx)(h.eb,{value:"syncing",children:"Syncing"}),(0,t.jsx)(h.eb,{value:"error",children:"Error"})]})]})]}),(0,t.jsxs)(x.$,{onClick:()=>y(!0),children:[(0,t.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"New Knowledge Base"]})]}),P?(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,s)=>(0,t.jsxs)("div",{className:"rounded-lg border border-border bg-card p-4",children:[(0,t.jsx)(p.EA,{className:"mb-4 h-10 w-10 rounded-lg"}),(0,t.jsx)(p.EA,{className:"mb-2 h-5 w-3/4"}),(0,t.jsx)(p.EA,{className:"mb-4 h-4 w-full"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(p.EA,{className:"h-5 w-16"}),(0,t.jsx)(p.EA,{className:"h-5 w-20"})]})]},s))}):0===F.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)(c.A,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground/50"}),(0,t.jsx)("h3",{className:"mb-2 text-lg font-medium",children:"No knowledge bases yet"}),(0,t.jsx)("p",{className:"mb-4 text-sm text-muted-foreground",children:"Create your first knowledge base to power AI-assisted responses."}),(0,t.jsxs)(x.$,{onClick:()=>y(!0),children:[(0,t.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Create Knowledge Base"]})]}):(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:F.map(e=>(0,t.jsx)(S,{knowledgeBase:e,onEdit:()=>_(e),onDelete:()=>E(e),onRegenerate:()=>I(e),isRegenerating:q.isPending&&q.variables===e.id},e.id))})]}),(0,t.jsx)(U,{open:v,onOpenChange:()=>{y(!1),k(null)},knowledgeBase:N})]})}},99926:(e,s,r)=>{"use strict";r.d(s,{C5:()=>g,MJ:()=>f,Rr:()=>j,eI:()=>p,lR:()=>h,lV:()=>o,zB:()=>m});var t=r(45512),a=r(58009),n=r(12705),l=r(6868),i=r(44195),d=r(52628);let o=l.Op,c=a.createContext({}),m=({...e})=>(0,t.jsx)(c.Provider,{value:{name:e.name},children:(0,t.jsx)(l.xI,{...e})}),x=()=>{let e=a.useContext(c),s=a.useContext(u),{getFieldState:r,formState:t}=(0,l.xW)(),n=r(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},u=a.createContext({}),p=a.forwardRef(({className:e,...s},r)=>{let n=a.useId();return(0,t.jsx)(u.Provider,{value:{id:n},children:(0,t.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",e),...s})})});p.displayName="FormItem";let h=a.forwardRef(({className:e,...s},r)=>{let{error:a,formItemId:n}=x();return(0,t.jsx)(d.J,{ref:r,className:(0,i.cn)(a&&"text-destructive",e),htmlFor:n,...s})});h.displayName="FormLabel";let f=a.forwardRef(({...e},s)=>{let{error:r,formItemId:a,formDescriptionId:l,formMessageId:i}=x();return(0,t.jsx)(n.DX,{ref:s,id:a,"aria-describedby":r?`${l} ${i}`:`${l}`,"aria-invalid":!!r,...e})});f.displayName="FormControl";let j=a.forwardRef(({className:e,...s},r)=>{let{formDescriptionId:a}=x();return(0,t.jsx)("p",{ref:r,id:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s})});j.displayName="FormDescription";let g=a.forwardRef(({className:e,children:s,...r},a)=>{let{error:n,formMessageId:l}=x(),d=n?String(n?.message):s;return d?(0,t.jsx)("p",{ref:a,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",e),...r,children:d}):null});g.displayName="FormMessage"},93732:(e,s,r)=>{"use strict";r.d(s,{bq:()=>x,eb:()=>f,gC:()=>h,l6:()=>c,yv:()=>m});var t=r(45512),a=r(58009),n=r(6625),l=r(98755),i=r(28638),d=r(24849),o=r(44195);let c=n.bL;n.YJ;let m=n.WT,x=a.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(n.l9,{ref:a,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[s,(0,t.jsx)(n.In,{asChild:!0,children:(0,t.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]}));x.displayName=n.l9.displayName;let u=a.forwardRef(({className:e,...s},r)=>(0,t.jsx)(n.PP,{ref:r,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})}));u.displayName=n.PP.displayName;let p=a.forwardRef(({className:e,...s},r)=>(0,t.jsx)(n.wn,{ref:r,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})}));p.displayName=n.wn.displayName;let h=a.forwardRef(({className:e,children:s,position:r="popper",...a},l)=>(0,t.jsx)(n.ZL,{children:(0,t.jsxs)(n.UC,{ref:l,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-card text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[(0,t.jsx)(u,{}),(0,t.jsx)(n.LM,{className:(0,o.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,t.jsx)(p,{})]})}));h.displayName=n.UC.displayName,a.forwardRef(({className:e,...s},r)=>(0,t.jsx)(n.JU,{ref:r,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=n.JU.displayName;let f=a.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(n.q7,{ref:a,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(n.VF,{children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})}),(0,t.jsx)(n.p4,{children:s})]}));f.displayName=n.q7.displayName,a.forwardRef(({className:e,...s},r)=>(0,t.jsx)(n.wv,{ref:r,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=n.wv.displayName},76534:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/page.tsx","default")},29374:(e,s,r)=>{"use strict";function t(e,[s,r]){return Math.min(r,Math.max(s,e))}r.d(s,{q:()=>t})}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[705,881,904,115,697,214,962,836,92,660,359,292],()=>r(37467));module.exports=t})();