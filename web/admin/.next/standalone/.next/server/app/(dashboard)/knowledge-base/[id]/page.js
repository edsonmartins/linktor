(()=>{var e={};e.id=201,e.ids=[201],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},38045:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var r=t(70260),a=t(28203),n=t(25155),l=t.n(n),i=t(67292),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let d=["",{children:["(dashboard)",{children:["knowledge-base",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,32034)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,58426)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,71354)),"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/[id]/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(dashboard)/knowledge-base/[id]/page",pathname:"/knowledge-base/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},96280:(e,s,t)=>{Promise.resolve().then(t.bind(t,32034))},6008:(e,s,t)=>{Promise.resolve().then(t.bind(t,68489))},35668:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},45037:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(41680).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},68489:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eK});var r=t(45512),a=t(58009),n=t(79334),l=t(28531),i=t.n(l),o=t(64186),d=t(33115),c=t(30191),m=t(4269),u=t(61075),x=t(74464),h=t(45037),p=t(35668),f=t(16873),j=t(92557),g=t(41680);let v=(0,g.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),w=(0,g.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var y=t(18741),b=t(37239),N=t(39400),k=t(78447),C=t(97093),A=t(64590),R=t(69586),S=t(63146),I=t(44195);let E=(0,g.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var $=t(17033),q=t(3736),P=t(49656),F=t(52706),_=t(99905),M=t(77722);let H=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,I.cn)("w-full caption-bottom text-sm",e),...s})}));H.displayName="Table";let K=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("thead",{ref:t,className:(0,I.cn)("[&_tr]:border-b",e),...s}));K.displayName="TableHeader";let T=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("tbody",{ref:t,className:(0,I.cn)("[&_tr:last-child]:border-0",e),...s}));T.displayName="TableBody",a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("tfoot",{ref:t,className:(0,I.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let B=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("tr",{ref:t,className:(0,I.cn)("border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));B.displayName="TableRow";let z=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("th",{ref:t,className:(0,I.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));z.displayName="TableHead";let V=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("td",{ref:t,className:(0,I.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));V.displayName="TableCell",a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("caption",{ref:t,className:(0,I.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";var O=t(35223);function Q({items:e,isLoading:s,searchQuery:t,onSearchChange:a,page:n,totalPages:l,onPageChange:i,onEdit:o,onDelete:d}){return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative max-w-sm",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,r.jsx)(M.p,{placeholder:"Search items...",value:t,onChange:e=>a(e.target.value),className:"pl-9"})]}),(0,r.jsx)("div",{className:"rounded-lg border border-border",children:(0,r.jsxs)(H,{children:[(0,r.jsx)(K,{children:(0,r.jsxs)(B,{children:[(0,r.jsx)(z,{className:"w-[30%]",children:"Question"}),(0,r.jsx)(z,{className:"w-[35%]",children:"Answer"}),(0,r.jsx)(z,{children:"Keywords"}),(0,r.jsx)(z,{children:"Source"}),(0,r.jsx)(z,{className:"w-[80px] text-center",children:"Embedding"}),(0,r.jsx)(z,{className:"w-[60px]"})]})}),(0,r.jsx)(T,{children:s?Array.from({length:5}).map((e,s)=>(0,r.jsxs)(B,{children:[(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"h-4 w-full"})}),(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"h-4 w-full"})}),(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"h-4 w-20"})}),(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"h-4 w-16"})}),(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"mx-auto h-4 w-4"})}),(0,r.jsx)(V,{children:(0,r.jsx)(C.EA,{className:"h-8 w-8"})})]},s)):0===e.length?(0,r.jsx)(B,{children:(0,r.jsx)(V,{colSpan:6,className:"h-32 text-center text-muted-foreground",children:t?"No items match your search.":"No items yet. Add your first item to get started."})}):e.map(e=>(0,r.jsxs)(B,{children:[(0,r.jsx)(V,{className:"font-medium",children:(0,I.xv)(e.question,60)}),(0,r.jsx)(V,{className:"text-muted-foreground",children:(0,I.xv)(e.answer,80)}),(0,r.jsx)(V,{children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.keywords?.slice(0,3).map(e=>r.jsx(k.E,{variant:"secondary",className:"text-xs",children:e},e)),e.keywords&&e.keywords.length>3&&(0,r.jsxs)(k.E,{variant:"outline",className:"text-xs",children:["+",e.keywords.length-3]})]})}),(0,r.jsx)(V,{className:"text-muted-foreground",children:e.source||"-"}),(0,r.jsx)(V,{className:"text-center",children:e.has_embedding?(0,r.jsx)(v,{className:"mx-auto h-4 w-4 text-success"}):(0,r.jsx)(E,{className:"mx-auto h-4 w-4 text-muted-foreground"})}),(0,r.jsx)(V,{children:(0,r.jsxs)(O.rI,{children:[(0,r.jsx)(O.ty,{asChild:!0,children:(0,r.jsx)(N.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)($.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(O.SQ,{align:"end",children:[(0,r.jsxs)(O._2,{onClick:()=>o(e),children:[(0,r.jsx)(q.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,r.jsxs)(O._2,{onClick:()=>d(e),className:"text-destructive",children:[(0,r.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]})}),l>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Page ",n," of ",l]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(N.$,{variant:"outline",size:"sm",onClick:()=>i(n-1),disabled:n<=1,children:[(0,r.jsx)(F.A,{className:"h-4 w-4"}),"Previous"]}),(0,r.jsxs)(N.$,{variant:"outline",size:"sm",onClick:()=>i(n+1),disabled:n>=l,children:["Next",(0,r.jsx)(_.A,{className:"h-4 w-4"})]})]})]})]})}var D=t(6868),W=t(19462),L=t(45009),U=t(44269),G=t(43264),J=t(99926),Z=t(75002),Y=t(54716);let X=L.Ik({question:L.Yj().min(1,"Question is required").max(1e3,"Question must be 1000 characters or less"),answer:L.Yj().min(1,"Answer is required").max(1e4,"Answer must be 10000 characters or less"),source:L.Yj().max(200).optional()});function ee({open:e,onOpenChange:s,knowledgeBaseId:t,item:n}){let l=(0,o.jE)(),i=!!n,[d,m]=(0,a.useState)([]),[u,x]=(0,a.useState)(""),h=(0,D.mN)({resolver:(0,W.u)(X),defaultValues:{question:"",answer:"",source:""}}),p=(0,c.n)({mutationFn:e=>R.FH.post(`/knowledge-bases/${t}/items`,e),onSuccess:()=>{l.invalidateQueries({queryKey:S.lH.knowledgeItems.list(t,{})}),l.invalidateQueries({queryKey:S.lH.knowledgeBases.detail(t)}),(0,Y.oR)({title:"Item created",description:"The item has been added to the knowledge base."}),s(!1)},onError:e=>{(0,Y.oR)({title:"Error",description:e.message||"Failed to create item",variant:"error"})}}),f=(0,c.n)({mutationFn:e=>R.FH.put(`/knowledge-bases/${t}/items/${n?.id}`,e),onSuccess:()=>{l.invalidateQueries({queryKey:S.lH.knowledgeItems.list(t,{})}),(0,Y.oR)({title:"Item updated",description:"The item has been updated successfully."}),s(!1)},onError:e=>{(0,Y.oR)({title:"Error",description:e.message||"Failed to update item",variant:"error"})}}),j=()=>{let e=u.trim().toLowerCase();e&&!d.includes(e)&&(m([...d,e]),x(""))},g=e=>{m(d.filter(s=>s!==e))},v=p.isPending||f.isPending;return(0,r.jsx)(G.lG,{open:e,onOpenChange:s,children:(0,r.jsxs)(G.Cf,{className:"sm:max-w-[600px]",children:[(0,r.jsxs)(G.c7,{children:[(0,r.jsx)(G.L3,{children:i?"Edit Item":"Add Item"}),(0,r.jsx)(G.rr,{children:i?"Update the question and answer for this knowledge item.":"Add a new question-answer pair to your knowledge base."})]}),(0,r.jsx)(J.lV,{...h,children:(0,r.jsxs)("form",{onSubmit:h.handleSubmit(e=>{let s={question:e.question,answer:e.answer,keywords:d.length>0?d:void 0,source:e.source||void 0};i?f.mutate(s):p.mutate(s)}),className:"space-y-4",children:[(0,r.jsx)(J.zB,{control:h.control,name:"question",render:({field:e})=>(0,r.jsxs)(J.eI,{children:[(0,r.jsx)(J.lR,{children:"Question"}),(0,r.jsx)(J.MJ,{children:(0,r.jsx)(Z.T,{placeholder:"e.g., How do I reset my password?",className:"resize-none",rows:2,...e})}),(0,r.jsx)(J.C5,{})]})}),(0,r.jsx)(J.zB,{control:h.control,name:"answer",render:({field:e})=>(0,r.jsxs)(J.eI,{children:[(0,r.jsx)(J.lR,{children:"Answer"}),(0,r.jsx)(J.MJ,{children:(0,r.jsx)(Z.T,{placeholder:"Provide a detailed answer...",className:"resize-none",rows:4,...e})}),(0,r.jsx)(J.C5,{})]})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(J.lR,{children:"Keywords (optional)"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(M.p,{placeholder:"Add a keyword...",value:u,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),j())}}),(0,r.jsx)(N.$,{type:"button",variant:"outline",onClick:j,children:(0,r.jsx)(y.A,{className:"h-4 w-4"})})]}),d.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:d.map(e=>(0,r.jsxs)(k.E,{variant:"secondary",className:"gap-1",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>g(e),className:"ml-1 hover:text-destructive",children:(0,r.jsx)(U.A,{className:"h-3 w-3"})})]},e))}),(0,r.jsx)(J.Rr,{children:"Keywords help with search relevance. Press Enter to add."})]}),(0,r.jsx)(J.zB,{control:h.control,name:"source",render:({field:e})=>(0,r.jsxs)(J.eI,{children:[(0,r.jsx)(J.lR,{children:"Source (optional)"}),(0,r.jsx)(J.MJ,{children:(0,r.jsx)(M.p,{placeholder:"e.g., FAQ v1.0, Help Center",...e})}),(0,r.jsx)(J.Rr,{children:"Track where this information came from."}),(0,r.jsx)(J.C5,{})]})}),(0,r.jsxs)(G.Es,{children:[(0,r.jsx)(N.$,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,r.jsx)(N.$,{type:"submit",disabled:v,children:v?"Saving...":i?"Save Changes":"Add Item"})]})]})})]})})}let es=(0,g.A)("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),et=(0,g.A)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var er=t(31412),ea=t(39165),en=t(98060);t(55740);var el=t(29952),ei=Symbol("radix.slottable");function eo(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ei}var ed=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let t=function(e){let s=function(e){let s=a.forwardRef((e,s)=>{let{children:t,...r}=e;if(a.isValidElement(t)){let e,n;let l=(e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?t.props.ref:t.props.ref||t.ref,i=function(e,s){let t={...s};for(let r in s){let a=e[r],n=s[r];/^on[A-Z]/.test(r)?a&&n?t[r]=(...e)=>{let s=n(...e);return a(...e),s}:a&&(t[r]=a):"style"===r?t[r]={...a,...n}:"className"===r&&(t[r]=[a,n].filter(Boolean).join(" "))}return{...e,...t}}(r,t.props);return t.type!==a.Fragment&&(i.ref=s?(0,el.t)(s,l):l),a.cloneElement(t,i)}return a.Children.count(t)>1?a.Children.only(null):null});return s.displayName=`${e}.SlotClone`,s}(e),t=a.forwardRef((e,t)=>{let{children:n,...l}=e,i=a.Children.toArray(n),o=i.find(eo);if(o){let e=o.props.children,n=i.map(s=>s!==o?s:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,r.jsx)(s,{...l,ref:t,children:a.isValidElement(e)?a.cloneElement(e,void 0,n):null})}return(0,r.jsx)(s,{...l,ref:t,children:n})});return t.displayName=`${e}.Slot`,t}(`Primitive.${s}`),n=a.forwardRef((e,a)=>{let{asChild:n,...l}=e,i=n?t:s;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(i,{...l,ref:a})});return n.displayName=`Primitive.${s}`,{...e,[s]:n}},{}),ec=t(59018),em=t(13024),eu=t(30096),ex="Tabs",[eh,ep]=function(e,s=[]){let t=[],n=()=>{let s=t.map(e=>a.createContext(e));return function(t){let r=t?.[e]||s;return a.useMemo(()=>({[`__scope${e}`]:{...t,[e]:r}}),[t,r])}};return n.scopeName=e,[function(s,n){let l=a.createContext(n),i=t.length;t=[...t,n];let o=s=>{let{scope:t,children:n,...o}=s,d=t?.[e]?.[i]||l,c=a.useMemo(()=>o,Object.values(o));return(0,r.jsx)(d.Provider,{value:c,children:n})};return o.displayName=s+"Provider",[o,function(t,r){let o=r?.[e]?.[i]||l,d=a.useContext(o);if(d)return d;if(void 0!==n)return n;throw Error(`\`${t}\` must be used within \`${s}\``)}]},function(...e){let s=e[0];if(1===e.length)return s;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=t.reduce((s,{useScope:t,scopeName:r})=>{let a=t(e)[`__scope${r}`];return{...s,...a}},{});return a.useMemo(()=>({[`__scope${s.scopeName}`]:r}),[r])}};return t.scopeName=s.scopeName,t}(n,...s)]}(ex,[ea.RG]),ef=(0,ea.RG)(),[ej,eg]=eh(ex),ev=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,onValueChange:n,defaultValue:l,orientation:i="horizontal",dir:o,activationMode:d="automatic",...c}=e,m=(0,ec.jH)(o),[u,x]=(0,em.i)({prop:a,onChange:n,defaultProp:l??"",caller:ex});return(0,r.jsx)(ej,{scope:t,baseId:(0,eu.B)(),value:u,onValueChange:x,orientation:i,dir:m,activationMode:d,children:(0,r.jsx)(ed.div,{dir:m,"data-orientation":i,...c,ref:s})})});ev.displayName=ex;var ew="TabsList",ey=a.forwardRef((e,s)=>{let{__scopeTabs:t,loop:a=!0,...n}=e,l=eg(ew,t),i=ef(t);return(0,r.jsx)(ea.bL,{asChild:!0,...i,orientation:l.orientation,dir:l.dir,loop:a,children:(0,r.jsx)(ed.div,{role:"tablist","aria-orientation":l.orientation,...n,ref:s})})});ey.displayName=ew;var eb="TabsTrigger",eN=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:a,disabled:n=!1,...l}=e,i=eg(eb,t),o=ef(t),d=eA(i.baseId,a),c=eR(i.baseId,a),m=a===i.value;return(0,r.jsx)(ea.q7,{asChild:!0,...o,focusable:!n,active:m,children:(0,r.jsx)(ed.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":c,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...l,ref:s,onMouseDown:(0,er.mK)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():i.onValueChange(a)}),onKeyDown:(0,er.mK)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&i.onValueChange(a)}),onFocus:(0,er.mK)(e.onFocus,()=>{let e="manual"!==i.activationMode;m||n||!e||i.onValueChange(a)})})})});eN.displayName=eb;var ek="TabsContent",eC=a.forwardRef((e,s)=>{let{__scopeTabs:t,value:n,forceMount:l,children:i,...o}=e,d=eg(ek,t),c=eA(d.baseId,n),m=eR(d.baseId,n),u=n===d.value,x=a.useRef(u);return a.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,r.jsx)(en.C,{present:l||u,children:({present:t})=>(0,r.jsx)(ed.div,{"data-state":u?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":c,hidden:!t,id:m,tabIndex:0,...o,ref:s,style:{...e.style,animationDuration:x.current?"0s":void 0},children:t&&i})})});function eA(e,s){return`${e}-trigger-${s}`}function eR(e,s){return`${e}-content-${s}`}eC.displayName=ek;let eS=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)(ey,{ref:t,className:(0,I.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));eS.displayName=ey.displayName;let eI=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)(eN,{ref:t,className:(0,I.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));eI.displayName=eN.displayName;let eE=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)(eC,{ref:t,className:(0,I.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));eE.displayName=eC.displayName;let e$=(0,t(21643).F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eq=a.forwardRef(({className:e,variant:s,...t},a)=>(0,r.jsx)("div",{ref:a,role:"alert",className:(0,I.cn)(e$({variant:s}),e),...t}));eq.displayName="Alert";let eP=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("h5",{ref:t,className:(0,I.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));eP.displayName="AlertTitle";let eF=a.forwardRef(({className:e,...s},t)=>(0,r.jsx)("div",{ref:t,className:(0,I.cn)("text-sm [&_p]:leading-relaxed",e),...s}));function e_({open:e,onOpenChange:s,knowledgeBaseId:t}){let n=(0,o.jE)(),l=(0,a.useRef)(null),[i,d]=(0,a.useState)("json"),[m,u]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),[f,j]=(0,a.useState)([]),[g,y]=(0,a.useState)([]),b=(0,c.n)({mutationFn:e=>R.FH.post(`/knowledge-bases/${t}/items/bulk`,{items:e}),onSuccess:e=>{n.invalidateQueries({queryKey:S.lH.knowledgeItems.list(t,{})}),n.invalidateQueries({queryKey:S.lH.knowledgeBases.detail(t)}),(0,Y.oR)({title:"Import completed",description:`Successfully imported ${e.created} items.${e.errors?.length>0?` ${e.errors.length} errors.`:""}`}),e.errors?.length>0?j(e.errors):k()},onError:e=>{(0,Y.oR)({title:"Import failed",description:e.message||"Failed to import items",variant:"error"})}}),k=()=>{u(""),p(""),j([]),y([]),s(!1)},C=e=>{try{let s=JSON.parse(e),t=s.items||s;if(!Array.isArray(t))throw Error("Expected an array of items");let r=[],a=[];return t.forEach((e,s)=>{if(!e.question||!e.answer){a.push(`Item ${s+1}: Missing question or answer`);return}r.push({question:String(e.question),answer:String(e.answer),keywords:Array.isArray(e.keywords)?e.keywords.map(String):void 0,source:e.source?String(e.source):void 0})}),a.length>0&&j(a),r}catch(e){return j([e.message||"Invalid JSON format"]),null}},A=e=>{try{let s=e.split("\n").filter(e=>e.trim());if(s.length<2)throw Error("CSV must have at least a header row and one data row");let t=s[0].split(",").map(e=>e.trim().toLowerCase()),r=t.indexOf("question"),a=t.indexOf("answer"),n=t.indexOf("keywords"),l=t.indexOf("source");if(-1===r||-1===a)throw Error('CSV must have "question" and "answer" columns');let i=[],o=[];for(let e=1;e<s.length;e++){let t=I(s[e]);if(!t[r]||!t[a]){o.push(`Row ${e+1}: Missing question or answer`);continue}i.push({question:t[r],answer:t[a],keywords:n>=0&&t[n]?t[n].split(";").map(e=>e.trim()).filter(Boolean):void 0,source:l>=0?t[l]:void 0})}return o.length>0&&j(o),i}catch(e){return j([e.message||"Invalid CSV format"]),null}},I=e=>{let s=[],t="",r=!1;for(let a=0;a<e.length;a++){let n=e[a];'"'===n&&(0===a||"\\"!==e[a-1])?r=!r:","!==n||r?t+=n:(s.push(t.trim()),t="")}return s.push(t.trim()),s},E=()=>{j([]),y([]);let e="json"===i?m:x;if(!e.trim()){j(["Please enter some data to import"]);return}let s="json"===i?C(e):A(e);s&&s.length>0&&y(s)};return(0,r.jsx)(G.lG,{open:e,onOpenChange:k,children:(0,r.jsxs)(G.Cf,{className:"sm:max-w-[700px]",children:[(0,r.jsxs)(G.c7,{children:[(0,r.jsx)(G.L3,{children:"Bulk Import"}),(0,r.jsx)(G.rr,{children:"Import multiple items at once using JSON or CSV format."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("input",{ref:l,type:"file",accept:".json,.csv",onChange:e=>{let s=e.target.files?.[0];if(!s)return;let t=new FileReader;t.onload=e=>{let t=e.target?.result;s.name.endsWith(".json")?(d("json"),u(t)):s.name.endsWith(".csv")&&(d("csv"),p(t)),j([]),y([])},t.readAsText(s),l.current&&(l.current.value="")},className:"hidden"}),(0,r.jsxs)(N.$,{variant:"outline",onClick:()=>l.current?.click(),children:[(0,r.jsx)(w,{className:"mr-2 h-4 w-4"}),"Upload File"]}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Supports .json and .csv files"})]}),(0,r.jsxs)(ev,{value:i,onValueChange:e=>d(e),children:[(0,r.jsxs)(eS,{className:"grid w-full grid-cols-2",children:[(0,r.jsxs)(eI,{value:"json",className:"flex items-center gap-2",children:[(0,r.jsx)(es,{className:"h-4 w-4"}),"JSON"]}),(0,r.jsxs)(eI,{value:"csv",className:"flex items-center gap-2",children:[(0,r.jsx)(et,{className:"h-4 w-4"}),"CSV"]})]}),(0,r.jsx)(eE,{value:"json",className:"space-y-2",children:(0,r.jsx)(Z.T,{placeholder:`{
  "items": [
    {
      "question": "How do I reset my password?",
      "answer": "Go to Settings > Security > Reset Password",
      "keywords": ["password", "reset", "security"],
      "source": "FAQ v1.0"
    }
  ]
}`,value:m,onChange:e=>{u(e.target.value),y([]),j([])},className:"font-mono text-sm min-h-[200px]"})}),(0,r.jsxs)(eE,{value:"csv",className:"space-y-2",children:[(0,r.jsx)(Z.T,{placeholder:`question,answer,keywords,source
"How do I reset my password?","Go to Settings > Security > Reset Password","password;reset;security","FAQ v1.0"
"What are your hours?","We're open 9am-5pm Monday to Friday","hours;schedule;availability","FAQ v1.0"`,value:x,onChange:e=>{p(e.target.value),y([]),j([])},className:"font-mono text-sm min-h-[200px]"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Use semicolons (;) to separate multiple keywords within the keywords column."})]})]}),f.length>0&&(0,r.jsxs)(eq,{variant:"destructive",children:[(0,r.jsx)(h.A,{className:"h-4 w-4"}),(0,r.jsx)(eP,{children:"Errors"}),(0,r.jsx)(eF,{children:(0,r.jsxs)("ul",{className:"list-disc list-inside text-sm",children:[f.slice(0,5).map((e,s)=>(0,r.jsx)("li",{children:e},s)),f.length>5&&(0,r.jsxs)("li",{children:["...and ",f.length-5," more errors"]})]})})]}),g.length>0&&0===f.length&&(0,r.jsxs)(eq,{children:[(0,r.jsx)(v,{className:"h-4 w-4"}),(0,r.jsx)(eP,{children:"Ready to Import"}),(0,r.jsxs)(eF,{children:[g.length," item",g.length>1?"s":""," parsed successfully."]})]})]}),(0,r.jsxs)(G.Es,{children:[(0,r.jsx)(N.$,{variant:"outline",onClick:k,children:"Cancel"}),(0,r.jsx)(N.$,{variant:"outline",onClick:E,disabled:!(m.trim()||x.trim()),children:"Validate"}),(0,r.jsx)(N.$,{onClick:()=>{if(0===g.length){E();return}if(g.length>100){j(["Maximum 100 items per import. Please split your data."]);return}b.mutate(g)},disabled:b.isPending||0===g.length&&f.length>0,children:b.isPending?"Importing...":g.length>0?`Import ${g.length} Items`:"Parse & Import"})]})]})})}eF.displayName="AlertDescription";let eM={faq:m.A,documents:u.A,website:x.A},eH={active:"success",syncing:"warning",error:"error"};function eK(){let e=(0,n.useParams)(),s=(0,n.useRouter)(),t=(0,o.jE)(),l=e.id,[u,x]=(0,a.useState)(!1),[g,E]=(0,a.useState)(null),[$,q]=(0,a.useState)(!1),[P,F]=(0,a.useState)(1),[_,M]=(0,a.useState)(""),{data:H,isLoading:K}=(0,d.I)({queryKey:S.lH.knowledgeBases.detail(l),queryFn:()=>R.FH.get(`/knowledge-bases/${l}`)}),{data:T,isLoading:B}=(0,d.I)({queryKey:S.lH.knowledgeItems.list(l,{page:P,search:_}),queryFn:()=>R.FH.get(`/knowledge-bases/${l}/items`,{page:String(P),page_size:"20",..._&&{search:_}})}),z=(0,c.n)({mutationFn:()=>R.FH.post(`/knowledge-bases/${l}/regenerate-embeddings`),onSuccess:()=>{t.invalidateQueries({queryKey:S.lH.knowledgeBases.detail(l)})}}),V=(0,c.n)({mutationFn:e=>R.FH.delete(`/knowledge-bases/${l}/items/${e}`),onSuccess:()=>{t.invalidateQueries({queryKey:S.lH.knowledgeItems.list(l,{})}),t.invalidateQueries({queryKey:S.lH.knowledgeBases.detail(l)})}}),O=T?.data||[],D=Math.ceil((T?.total||0)/20),W=H?eM[H.type]:m.A,L=O.filter(e=>e.has_embedding).length,U=async e=>{confirm("Are you sure you want to delete this item?")&&await V.mutateAsync(e.id)};return K?(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(b.Y,{title:"Knowledge Base"}),(0,r.jsxs)("div",{className:"flex-1 p-6",children:[(0,r.jsx)(C.EA,{className:"mb-4 h-8 w-64"}),(0,r.jsx)(C.EA,{className:"mb-6 h-24 w-full"}),(0,r.jsx)(C.EA,{className:"h-96 w-full"})]})]}):H?(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(b.Y,{title:"Knowledge Base"}),(0,r.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)(i(),{href:"/knowledge-base",className:"mb-2 inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(p.A,{className:"mr-1 h-4 w-4"}),"Back to Knowledge Bases"]}),(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:(0,r.jsx)(W,{className:"h-6 w-6 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:H.name}),(0,r.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,r.jsx)(k.E,{variant:"secondary",children:H.type.toUpperCase()}),(0,r.jsx)(k.E,{variant:eH[H.status],children:H.status})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(N.$,{variant:"outline",asChild:!0,children:(0,r.jsxs)(i(),{href:`/knowledge-base/${l}/search`,children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Test Search"]})}),(0,r.jsxs)(N.$,{variant:"outline",onClick:()=>z.mutate(),disabled:z.isPending,children:[(0,r.jsx)(j.A,{className:`mr-2 h-4 w-4 ${z.isPending?"animate-spin":""}`}),"Regenerate Embeddings"]})]})]}),H.description&&(0,r.jsx)("p",{className:"mt-4 text-muted-foreground",children:H.description})]}),(0,r.jsxs)("div",{className:"mb-6 grid gap-4 md:grid-cols-4",children:[(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Items"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:H.item_count})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"With Embeddings"}),(0,r.jsxs)("p",{className:"text-2xl font-bold flex items-center gap-2",children:[L,L===O.length&&O.length>0&&(0,r.jsx)(v,{className:"h-5 w-5 text-success"})]})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Last Synced"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:H.last_sync_at?(0,I.mo)(H.last_sync_at):"Never"})]})}),(0,r.jsx)(A.Zp,{children:(0,r.jsxs)(A.Wu,{className:"p-4",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:(0,I.mo)(H.created_at)})]})})]}),(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Items"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(N.$,{variant:"outline",onClick:()=>q(!0),children:[(0,r.jsx)(w,{className:"mr-2 h-4 w-4"}),"Bulk Import"]}),(0,r.jsxs)(N.$,{onClick:()=>x(!0),children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Add Item"]})]})]}),(0,r.jsx)(Q,{items:O,isLoading:B,searchQuery:_,onSearchChange:M,page:P,totalPages:D,onPageChange:F,onEdit:e=>{E(e),x(!0)},onDelete:U})]}),(0,r.jsx)(ee,{open:u,onOpenChange:()=>{x(!1),E(null)},knowledgeBaseId:l,item:g}),(0,r.jsx)(e_,{open:$,onOpenChange:q,knowledgeBaseId:l})]}):(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsx)(b.Y,{title:"Knowledge Base"}),(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(h.A,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h2",{className:"mb-2 text-lg font-medium",children:"Knowledge base not found"}),(0,r.jsx)("p",{className:"mb-4 text-sm text-muted-foreground",children:"The knowledge base you're looking for doesn't exist."}),(0,r.jsxs)(N.$,{onClick:()=>s.push("/knowledge-base"),children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Back to Knowledge Bases"]})]})})]})}},99926:(e,s,t)=>{"use strict";t.d(s,{C5:()=>g,MJ:()=>f,Rr:()=>j,eI:()=>h,lR:()=>p,lV:()=>d,zB:()=>m});var r=t(45512),a=t(58009),n=t(12705),l=t(6868),i=t(44195),o=t(52628);let d=l.Op,c=a.createContext({}),m=({...e})=>(0,r.jsx)(c.Provider,{value:{name:e.name},children:(0,r.jsx)(l.xI,{...e})}),u=()=>{let e=a.useContext(c),s=a.useContext(x),{getFieldState:t,formState:r}=(0,l.xW)(),n=t(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=s;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},x=a.createContext({}),h=a.forwardRef(({className:e,...s},t)=>{let n=a.useId();return(0,r.jsx)(x.Provider,{value:{id:n},children:(0,r.jsx)("div",{ref:t,className:(0,i.cn)("space-y-2",e),...s})})});h.displayName="FormItem";let p=a.forwardRef(({className:e,...s},t)=>{let{error:a,formItemId:n}=u();return(0,r.jsx)(o.J,{ref:t,className:(0,i.cn)(a&&"text-destructive",e),htmlFor:n,...s})});p.displayName="FormLabel";let f=a.forwardRef(({...e},s)=>{let{error:t,formItemId:a,formDescriptionId:l,formMessageId:i}=u();return(0,r.jsx)(n.DX,{ref:s,id:a,"aria-describedby":t?`${l} ${i}`:`${l}`,"aria-invalid":!!t,...e})});f.displayName="FormControl";let j=a.forwardRef(({className:e,...s},t)=>{let{formDescriptionId:a}=u();return(0,r.jsx)("p",{ref:t,id:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s})});j.displayName="FormDescription";let g=a.forwardRef(({className:e,children:s,...t},a)=>{let{error:n,formMessageId:l}=u(),o=n?String(n?.message):s;return o?(0,r.jsx)("p",{ref:a,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",e),...t,children:o}):null});g.displayName="FormMessage"},32034:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/edsonmartins/desenvolvimento/linktor/web/admin/src/app/(dashboard)/knowledge-base/[id]/page.tsx","default")}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[705,881,904,115,697,214,962,92,660,359,292],()=>t(38045));module.exports=r})();